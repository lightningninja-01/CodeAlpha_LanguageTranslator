<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Language Translator</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <div class="box">
    <h2>🌐 Language Translator</h2>
    <textarea id="inputText" placeholder="Enter your text here..."></textarea><br/>

    <select id="sourceLang">
      <option value="en">English</option>
      <option value="hi">Hindi</option>
      <option value="es">Spanish</option>
      <option value="fr">French</option>
      <option value="de">German</option>
    </select>

    ➡

    <select id="targetLang">
      <option value="hi">Hindi</option>
      <option value="en">English</option>
      <option value="es">Spanish</option>
      <option value="fr">French</option>
      <option value="de">German</option>
    </select><br/>

    <button onclick="translateText()">Translate</button>
    <button onclick="copyText()">📋 Copy</button>
    <button onclick="speakText()">🔊 Speak</button>

    <div id="output"></div>
  </div>

  <script>
    async function translateText() {
      const input = document.getElementById("inputText").value.trim();
      const source = document.getElementById("sourceLang").value;
      const target = document.getElementById("targetLang").value;

      if (!input) {
        alert("Enter some text first!");
        return;
      }

      try {
        const res = await fetch("/translate", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            q: input,
            source: source,
            target: target
          })
        });

        const data = await res.json();
        if (data.translatedText) {
          document.getElementById("output").innerText = data.translatedText;
        } else {
          document.getElementById("output").innerText = "⚠️ Translation failed.";
        }
      } catch (err) {
        console.error("Translation error:", err);
        document.getElementById("output").innerText = "❌ Error connecting to translation server.";
      }
    }

    function copyText() {
      const text = document.getElementById("output").innerText;
      if (!text) return alert("Nothing to copy.");
      navigator.clipboard.writeText(text).then(() => alert("Copied!"));
    }

    function speakText() {
      const text = document.getElementById("output").innerText;
      if (!text) return alert("Nothing to speak.");
      const utterance = new SpeechSynthesisUtterance(text);
      speechSynthesis.speak(utterance);
    }
  </script>
</body>
</html>
